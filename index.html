<script>
    // ... (outras funções permanecem iguais)

    function exportPDF() {
        const selectedMonth = document.getElementById('monthFilter').value;
        if (!selectedMonth) {
            alert("Selecione um mês para exportar o relatório.");
            return;
        }

        const [year, month] = selectedMonth.split("-");
        const monthText = new Date(year, month - 1).toLocaleString("pt-BR", { month: "long" });
        const filtered = recordedDebts.filter(debt => debt.dueDate.startsWith(selectedMonth));

        if (filtered.length === 0) {
            alert(`Nenhuma dívida encontrada para ${monthText}/${year}`);
            return;
        }

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Configurações iniciais
        doc.setFont("helvetica");
        doc.setFontSize(16);
        doc.setTextColor(40);
        doc.text(`Relatório de Dívidas - ${monthText.toUpperCase()} ${year}`, 105, 15, { align: 'center' });
        
        // Cabeçalhos da tabela
        const headers = [["Empresa", "Funcionário", "Valor (R$)", "Vencimento", "Descrição"]];
        
        // Dados da tabela
        const data = filtered.map(debt => [
            debt.company,
            debt.employee,
            debt.installmentValue.toFixed(2),
            formatDate(debt.dueDate),
            debt.description || ''
        ]);
        
        // Configurações da tabela
        doc.autoTable({
            head: headers,
            body: data,
            startY: 25,
            theme: 'grid',
            headStyles: {
                fillColor: [64, 115, 246],
                textColor: 255,
                fontStyle: 'bold'
            },
            styles: {
                fontSize: 10,
                cellPadding: 3,
                overflow: 'linebreak'
            },
            columnStyles: {
                0: { cellWidth: 30 },
                1: { cellWidth: 30 },
                2: { cellWidth: 20 },
                3: { cellWidth: 25 },
                4: { cellWidth: 'auto' }
            },
            margin: { left: 10, right: 10 }
        });

        // Total e rodapé
        const total = filtered.reduce((sum, debt) => sum + debt.installmentValue, 0);
        const finalY = doc.lastAutoTable.finalY || 25;
        
        doc.setFontSize(12);
        doc.text(`Total: R$ ${total.toFixed(2)}`, 14, finalY + 10);
        doc.text(`Data de emissão: ${formatDate(new Date().toISOString().slice(0, 10))}`, 
                105, finalY + 10, { align: 'center' });
        
        doc.save(`Relatorio_Dividas_${monthText}_${year}.pdf`);
    }

    // ... (outras funções permanecem iguais)
</script>